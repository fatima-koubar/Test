async function triggerPutTokenError(errorPayload: any) {
  const apiError = new APIError(errorPayload as any);
  applePayApiSpy.putToken.and.returnValue(throwError(() => apiError));
  await service.putToken('token-123');
}


const testCases = [
  {
    errorType: CARD_ERRORS.CARD_NOT_ACCEPTED,
    expectedKey: 'PAYMENT_MEANS.APPLE_PAY.ERRORS.CARD_NOT_ACCEPTED',
  },
  {
    errorType: CARD_ERRORS.EXPIRATION_DATE_EXPIRED,
    expectedKey: 'PAYMENT_MEANS.APPLE_PAY.ERRORS.EXPIRED',
  },
  {
    errorType: CARD_ERRORS.INVALID_CARD,
    expectedKey: 'PAYMENT_MEANS.APPLE_PAY.ERRORS.INVALID',
  },
];

testCases.forEach(({ errorType, expectedKey }) => {
  it(`should notify ${errorType} error`, async () => {
    await triggerPutTokenError({
      error: {
        error: {
          type: errorType,
        },
      },
    });

    expect(toastrServiceSpy.notify).toHaveBeenCalledWith(expectedKey);
  });
});


it('should notify EXPIRATION_DATE_NOT_ACCEPTED with params', async () => {
  await triggerPutTokenError({
    error: {
      error: {
        type: CARD_ERRORS.EXPIRATION_DATE_NOT_ACCEPTED,
      },
      restriction_delay: 6,
    },
  });

  expect(toastrServiceSpy.notify).toHaveBeenCalledWith(
    'PAYMENT_MEANS.APPLE_PAY.ERRORS.RESTRICTION_EXPIRATION_DATE',
    { months: 6 },
  );
});

