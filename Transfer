I have this class, and I have an error when running the unit test ( Expected function to throw an Error.)


export abstract class ApplePayAdapterService {
  private readonly APPLE_PAY_SDK_URL =
    'https://applepay.com/apple-pay-sdk.js';
  private readonly INTEGRITY_HASH =
    'sha384-DZRWMZ';
  private readonly _ressourceLoader = inject(RessourceLoaderService);

  async loadScript(): Promise<void> {
    try {
      await this._ressourceLoader.loadScript(this.APPLE_PAY_SDK_URL, {
        integrity: this.INTEGRITY_HASH,
        crossOrigin: 'anonymous',
      });
    } catch (error) {
      throw new Error((error as Error).message);
    }
  }
}


unit test file: 
fdescribe('ApplePayAdapterService', () => {
  let service: ApplePayAdapterService;
  let ressourceLoaderSpy: jasmine.SpyObj<RessourceLoaderService>;
  let mockWindow: any;

  beforeEach(() => {
    ressourceLoaderSpy = jasmine.createSpyObj('RessourceLoaderService', [
      'loadScript',
      'getLoadedResource',
    ]);

    mockWindow = {
      ApplePaySession: {
        canMakePayments: jasmine.createSpy().and.returnValue(true),
        applePayCapabilities: jasmine
          .createSpy()
          .and.resolveTo({ paymentCredentialStatus: 'applePaySupported' }),
      },
    };

    TestBed.configureTestingModule({
      providers: [
        ApplePayAdapterService,
        { provide: RessourceLoaderService, useValue: ressourceLoaderSpy },
        { provide: WINDOW, useValue: mockWindow },
      ],
    });

    service = TestBed.inject(ApplePayAdapterService);
  });
it('should throw an error if script loading fails', () => {
      ressourceLoaderSpy.loadScript.and.throwError('Load failed');

      expect(() => service.loadScript()).toThrowError('Load failed');
    });
